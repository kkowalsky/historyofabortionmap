function initialize(){setMap()}function setMap(){function e(e,a,o,s,n,i){function c(e,t,a){for(var r=s.objects.states.geometries,o=0;o<t.length;o++)for(var n=t[o],i=n.adm,c=0;c<r.length;c++)if(r[c].properties.postal==i){attrObj={};for(var l in yearsArray){var d=yearsArray[l],p=n[d];attrObj[d]=p}r[c].properties[a]=attrObj;break}}colorize=colorScale(o),joinedJson=topojson.feature(s,s.objects.states).features;var l=[a,o],d=["ConsentData","gradeData"];for(csv in l)c(s,l[csv],d[csv]);console.log(topojson.feature(s,s.objects.states).features);for(var p=(t.selectAll(".states").data(joinedJson).enter().append("path").attr("class",function(e){return console.log(e),"states "+e.properties.postal}).attr("d",function(e){return r(e)}),[]),f=0;f<n.features.length;f++){var u=n.features[f].properties.Count;p.push(Number(u))}for(var h=Math.min.apply(Math,p),v=Math.max.apply(Math,p),g=d3.scale.sqrt().domain([h,v]).range([2,15]),b=[],m=0;m<i.features.length;m++){var y=i.features[m].properties.Count;b.push(Number(y))}Math.min.apply(Math,b),Math.max.apply(Math,b);overlay(r,g,t,n,i),setChart()}var t=d3.select(".map").append("svg").attr("width",mapWidth).attr("height",mapHeight).attr("class","us-map"),a=d3.geo.albersUsa().scale(1e3).translate([mapWidth/2,mapHeight/2]),r=d3.geo.path().projection(a);queue().defer(d3.csv,"data/consent.csv").defer(d3.csv,"data/Grades.csv").defer(d3.json,"data/usa.topojson").defer(d3.json,"data/CPCS.geojson").defer(d3.json,"data/AbortionProviders.geojson").await(e)}function drawMenu(){}function cpcPoints(e,t,a,r){e.selectAll(".cpcLocations").data(t.features).enter().append("path").attr("class","cpcLocations").attr("d",a.pointRadius(function(e){return r(e.properties.Count)}))}function abortionPoints(e,t,a,r){e.selectAll(".abortionLocations").data(t.features).enter().append("path").attr("class","abortionLocations").attr("d",a.pointRadius(function(e){return r(e.properties.Count)}))}function overlay(e,t,a,r,o){$(".cpc-section").click(function(){d3.selectAll(".cpcLocations")[0].length>0?removeCPC=d3.selectAll(".cpcLocations").remove():cpcPoints(a,r,e,t)}),$(".abortion-section").click(function(){d3.selectAll(".abortionLocations")[0].length>0?removeAbortion=d3.selectAll(".abortionLocations").remove():abortionPoints(a,o,e,t)})}function changeAttribute(){}function colorScale(){}function choropleth(e){var t=e.properties?e.properties[expressed]:e[expressed];return t?void 0:"#ccc"}function setChart(){{var e=d3.select(".graph").append("svg").attr("width","90%").attr("height","90%").attr("class","chart");d3.select(e).append("svg").attr("")}}var mapWidth=850,mapHeight=600,yearsArray=["grade","Pre-1973","1973","1974","1975","1976","1977","1977","1977","1978","1979","1980","1981","1982","1983","1984","1983","1984","1985","1986","1987","1988","1989","1989","1990","1991","1992","1993","1994","1995","1996","1997","1998","1999","2001","2002","2003","2004","2005","2006","2007","2008","2009","2010","2011","2012","2013","2014"],Category=["gradeData","ConsentData"],expressed=Category[0],removeCPC,removeAbortion,joinedJson;window.onload=initialize(),colorArrayOverview=["#252525","#636363","#969696","#cccccc","#f7f7f7"],colorArrayProhibited=["#252525","#636363","#969696","#bdbdbd","#d9d9d9","#f7f7f7"],colorArrayCounseling=["#252525","#f7f7f7"],colorArrayConsent=["#252525","#969696","#f7f7f7"],colorArrayUltrasound=["#252525","#636363","#969696","#f7f7f7"],arrayOverview=["F","D","C","B","A"],arrayProhibited=["12 weeks","20 weeks","22 weeks","24 weeks","3rd trimester","Viability"],arrayCounseling=["Yes","No"],arrayWaitingPeriod=["72 hours","48 hours","24 hours","18 hours","None"],arrayConsent=["Consent","Notice","None"],arrayUltrasound=["Must be performed, offer to view","Must be performed","Must be offered","None"],$(function(){$(".nav li a").on("click",function(){var e=$(this).parent("li"),t=e.parent("ul");e.hasClass("active")||(t.find("li.active").removeClass("active"),e.addClass("active"))})});