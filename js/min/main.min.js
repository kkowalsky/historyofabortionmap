function initialize(){setMap()}function setMap(){function t(t,a,r,s,n,i){function c(t,e,a){for(var o=s.objects.states.geometries,r=0;r<e.length;r++)for(var n=e[r],i=n.adm,c=0;c<o.length;c++)if(o[c].properties.postal==i){attrObj={};for(var l in yearsArray){var p=yearsArray[l],d=n[p];attrObj[p]=d}o[c].properties[a]=attrObj;break}}colorize=colorScale(r),joinedJson=topojson.feature(s,s.objects.states).features,console.log(joinedJson);var l=[a,r],p=["ConsentData","gradeData"];for(csv in l)c(s,l[csv],p[csv]);e.append("path").datum(topojson.feature(s,s.objects.states)).attr("class","states").attr("d",o);console.log(topojson.feature(s,s.objects.states).features);for(var d=(e.selectAll(".states").data(topojson.feature(s,s.objects.states).features).enter().append("g").style("fill","rgba(100,0,0,0.5").attr("class","choropleth").append("path").attr("class",function(t){return t.properties.postal}).attr("d",o),[]),f=0;f<n.features.length;f++){var u=n.features[f].properties.Count;d.push(Number(u))}for(var h=Math.min.apply(Math,d),v=Math.max.apply(Math,d),g=d3.scale.sqrt().domain([h,v]).range([2,15]),b=[],m=0;m<i.features.length;m++){var y=i.features[m].properties.Count;b.push(Number(y))}Math.min.apply(Math,b),Math.max.apply(Math,b);overlay(o,g,e,n,i),setChart()}var e=d3.select(".map").append("svg").attr("width",mapWidth).attr("height",mapHeight).attr("class","us-map"),a=d3.geo.albersUsa().scale(1e3).translate([mapWidth/2,mapHeight/2]),o=d3.geo.path().projection(a);queue().defer(d3.csv,"data/consent.csv").defer(d3.csv,"data/Grades.csv").defer(d3.json,"data/usa.topojson").defer(d3.json,"data/CPCS.geojson").defer(d3.json,"data/AbortionProviders.geojson").await(t)}function drawMenu(){}function cpcPoints(t,e,a,o){t.selectAll(".cpcLocations").data(e.features).enter().append("path").attr("class","cpcLocations").attr("d",a.pointRadius(function(t){return o(t.properties.Count)}))}function abortionPoints(t,e,a,o){t.selectAll(".abortionLocations").data(e.features).enter().append("path").attr("class","abortionLocations").attr("d",a.pointRadius(function(t){return o(t.properties.Count)}))}function overlay(t,e,a,o,r){$(".cpc-section").click(function(){d3.selectAll(".cpcLocations")[0].length>0?removeCPC=d3.selectAll(".cpcLocations").remove():cpcPoints(a,o,t,e)}),$(".abortion-section").click(function(){d3.selectAll(".abortionLocations")[0].length>0?removeAbortion=d3.selectAll(".abortionLocations").remove():abortionPoints(a,r,t,e)})}function changeAttribute(){}function colorScale(){}function choropleth(t){var e=t.properties?t.properties[expressed]:t[expressed];return e?void 0:"#ccc"}function setChart(){d3.select(".graph").append("svg").attr("width","600px").attr("height","200px").attr("class","chart");console.log(joinedJson)}var mapWidth=850,mapHeight=600,yearsArray=["grade","Pre-1973","1973","1974","1975","1976","1977","1977","1977","1978","1979","1980","1981","1982","1983","1984","1983","1984","1985","1986","1987","1988","1989","1989","1990","1991","1992","1993","1994","1995","1996","1997","1998","1999","2001","2002","2003","2004","2005","2006","2007","2008","2009","2010","2011","2012","2013","2014"],Category=["gradeData","ConsentData"],expressed=Category[0],removeCPC,removeAbortion,joinedJson;window.onload=initialize(),colorArrayOverview=["#252525","#636363","#969696","#cccccc","#f7f7f7"],colorArrayProhibited=["#252525","#636363","#969696","#bdbdbd","#d9d9d9","#f7f7f7"],colorArrayCounseling=["#252525","#f7f7f7"],colorArrayConsent=["#252525","#969696","#f7f7f7"],colorArrayUltrasound=["#252525","#636363","#969696","#f7f7f7"],arrayOverview=["F","D","C","B","A"],arrayProhibited=["12 weeks","20 weeks","22 weeks","24 weeks","3rd trimester","Viability"],arrayCounseling=["Yes","No"],arrayWaitingPeriod=["72 hours","48 hours","24 hours","18 hours","None"],arrayConsent=["Consent","Notice","None"],arrayUltrasound=["Must be performed, offer to view","Must be performed","Must be offered","None"],$(function(){$(".nav li a").on("click",function(){var t=$(this).parent("li"),e=t.parent("ul");t.hasClass("active")||(e.find("li.active").removeClass("active"),t.addClass("active"))})});